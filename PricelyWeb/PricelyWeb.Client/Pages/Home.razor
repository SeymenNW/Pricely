@page "/"
@using Pricely.Libraries.Services.Models.PriceRunner
@using Pricely.Libraries.Services.Services

@inject IGetPriceRunnerResults _getPriceRunnerResults

<PageTitle>Hjem</PageTitle>

<MudText Typo="Typo.h4" GutterBottom="true">Søg med Pricely!</MudText>
<MudText Class="mb-8">Pricely 1.0. Pricely Søgning henter data ned fra alle understøttede butikker.</MudText>
    <MudTextField @bind-Value="SearchText"  Label="Søg på over 4 millioner produkter..." Variant="Variant.Outlined"></MudTextField>
<MudButton Variant="Variant.Filled" @onclick="() =>  GetPrices(SearchText)" DropShadow="false" Color="Color.Primary">SØG PRICELY</MudButton>

@foreach (var item in Results.ProductResults)
{
    <MudText>@item.Name</MudText>
}


@code{
    public PriceRunnerSearchResults Results { get; set; } = new();
    public string SearchText { get; set; }

    public async Task GetPrices(string search)
    {
        Results = await _getPriceRunnerResults.GetProductsFromSearch(search);
        StateHasChanged();
    }

    protected override async Task OnInitializedAsync()
    {
     
        // Results =  await _getPriceRunnerResults.GetProductsFromSearch("");
    }

}